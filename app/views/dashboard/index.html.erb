<div class="container">

  <div class="starter-template">
    <h1>Servers</h1>
    <table class="table table-striped table-hover">
      <thead>
      <tr>
        <th>Name</th>
        <th>IP</th>
        <th>Last Heartbeat</th>
        <th>Uptime</th>
        <th>CPU Usage</th>
        <th>Memory Usage</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <% @servers.each do |server| %>
          <tr>
            <td><%= server.name %></td>
            <td><%= server.ip %></td>
            <td><%= server.last_heartbeat ? server.last_heartbeat : 'None' %></td>
            <td><%= server.heartbeats.size > 0 ? server.heartbeats.last.uptime : 'None' %></td>
            <td><%= server.heartbeats.size > 0 ? server.heartbeats.last.cpu_usage.to_s + '%' : 'None' %></td>
            <td><%= server.heartbeats.size > 0 ? ((server.heartbeats.last.mem_used.to_f / server.heartbeats.last.mem_total.to_f).round(3) * 100).round(2).to_s + '%' : 'Unknown' %></td>
            <td>
              <%= link_to edit_server_path(server) do %>
                  <span class="glyphicon glyphicon-pencil"></span>
              <% end %>
            </td>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
